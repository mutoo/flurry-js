(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function yt(t){if(!(typeof window>"u")){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=t,document.head.appendChild(e),t}}function Z(t,e){var n=t.__state.conversionName.toString(),i=Math.round(t.r),r=Math.round(t.g),s=Math.round(t.b),o=t.a,d=Math.round(t.h),l=t.s.toFixed(1),h=t.v.toFixed(1);if(e||n==="THREE_CHAR_HEX"||n==="SIX_CHAR_HEX"){for(var m=t.hex.toString(16);m.length<6;)m="0"+m;return"#"+m}else{if(n==="CSS_RGB")return"rgb("+i+","+r+","+s+")";if(n==="CSS_RGBA")return"rgba("+i+","+r+","+s+","+o+")";if(n==="HEX")return"0x"+t.hex.toString(16);if(n==="RGB_ARRAY")return"["+i+","+r+","+s+"]";if(n==="RGBA_ARRAY")return"["+i+","+r+","+s+","+o+"]";if(n==="RGB_OBJ")return"{r:"+i+",g:"+r+",b:"+s+"}";if(n==="RGBA_OBJ")return"{r:"+i+",g:"+r+",b:"+s+",a:"+o+"}";if(n==="HSV_OBJ")return"{h:"+d+",s:"+l+",v:"+h+"}";if(n==="HSVA_OBJ")return"{h:"+d+",s:"+l+",v:"+h+",a:"+o+"}"}return"unknown format"}var Ue=Array.prototype.forEach,te=Array.prototype.slice,u={BREAK:{},extend:function(e){return this.each(te.call(arguments,1),function(n){var i=this.isObject(n)?Object.keys(n):[];i.forEach((function(r){this.isUndefined(n[r])||(e[r]=n[r])}).bind(this))},this),e},defaults:function(e){return this.each(te.call(arguments,1),function(n){var i=this.isObject(n)?Object.keys(n):[];i.forEach((function(r){this.isUndefined(e[r])&&(e[r]=n[r])}).bind(this))},this),e},compose:function(){var e=te.call(arguments);return function(){for(var n=te.call(arguments),i=e.length-1;i>=0;i--)n=[e[i].apply(this,n)];return n[0]}},each:function(e,n,i){if(e){if(Ue&&e.forEach&&e.forEach===Ue)e.forEach(n,i);else if(e.length===e.length+0){var r=void 0,s=void 0;for(r=0,s=e.length;r<s;r++)if(r in e&&n.call(i,e[r],r)===this.BREAK)return}else for(var o in e)if(n.call(i,e[o],o)===this.BREAK)return}},defer:function(e){setTimeout(e,0)},debounce:function(e,n,i){var r=void 0;return function(){var s=this,o=arguments;function d(){r=null,i||e.apply(s,o)}var l=i||!r;clearTimeout(r),r=setTimeout(d,n),l&&e.apply(s,o)}},toArray:function(e){return e.toArray?e.toArray():te.call(e)},isUndefined:function(e){return e===void 0},isNull:function(e){return e===null},isNaN:function(t){function e(n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return isNaN(t)}),isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return e instanceof Function}},Et=[{litmus:u.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var n=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return n===null?!1:{space:"HEX",hex:parseInt("0x"+n[1].toString()+n[1].toString()+n[2].toString()+n[2].toString()+n[3].toString()+n[3].toString(),0)}},write:Z},SIX_CHAR_HEX:{read:function(e){var n=e.match(/^#([A-F0-9]{6})$/i);return n===null?!1:{space:"HEX",hex:parseInt("0x"+n[1].toString(),0)}},write:Z},CSS_RGB:{read:function(e){var n=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return n===null?!1:{space:"RGB",r:parseFloat(n[1]),g:parseFloat(n[2]),b:parseFloat(n[3])}},write:Z},CSS_RGBA:{read:function(e){var n=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return n===null?!1:{space:"RGB",r:parseFloat(n[1]),g:parseFloat(n[2]),b:parseFloat(n[3]),a:parseFloat(n[4])}},write:Z}}},{litmus:u.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:u.isArray,conversions:{RGB_ARRAY:{read:function(e){return e.length!==3?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return e.length!==4?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:u.isObject,conversions:{RGBA_OBJ:{read:function(e){return u.isNumber(e.r)&&u.isNumber(e.g)&&u.isNumber(e.b)&&u.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return u.isNumber(e.r)&&u.isNumber(e.g)&&u.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return u.isNumber(e.h)&&u.isNumber(e.s)&&u.isNumber(e.v)&&u.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return u.isNumber(e.h)&&u.isNumber(e.s)&&u.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],ne=void 0,fe=void 0,ke=function(){fe=!1;var e=arguments.length>1?u.toArray(arguments):arguments[0];return u.each(Et,function(n){if(n.litmus(e))return u.each(n.conversions,function(i,r){if(ne=i.read(e),fe===!1&&ne!==!1)return fe=ne,ne.conversionName=r,ne.conversion=i,u.BREAK}),u.BREAK}),fe},ze=void 0,be={hsv_to_rgb:function(e,n,i){var r=Math.floor(e/60)%6,s=e/60-Math.floor(e/60),o=i*(1-n),d=i*(1-s*n),l=i*(1-(1-s)*n),h=[[i,l,o],[d,i,o],[o,i,l],[o,d,i],[l,o,i],[i,o,d]][r];return{r:h[0]*255,g:h[1]*255,b:h[2]*255}},rgb_to_hsv:function(e,n,i){var r=Math.min(e,n,i),s=Math.max(e,n,i),o=s-r,d=void 0,l=void 0;if(s!==0)l=o/s;else return{h:NaN,s:0,v:0};return e===s?d=(n-i)/o:n===s?d=2+(i-e)/o:d=4+(e-n)/o,d/=6,d<0&&(d+=1),{h:d*360,s:l,v:s/255}},rgb_to_hex:function(e,n,i){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,n),r=this.hex_with_component(r,0,i),r},component_from_hex:function(e,n){return e>>n*8&255},hex_with_component:function(e,n,i){return i<<(ze=n*8)|e&~(255<<ze)}},xt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},U=function(){function t(e,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),Y=function t(e,n,i){e===null&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(r===void 0){var s=Object.getPrototypeOf(e);return s===null?void 0:t(s,n,i)}else{if("value"in r)return r.value;var o=r.get;return o===void 0?void 0:o.call(i)}},j=function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},W=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t},O=function(){function t(){if(V(this,t),this.__state=ke.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return U(t,[{key:"toString",value:function(){return Z(this)}},{key:"toHexString",value:function(){return Z(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),t}();function Be(t,e,n){Object.defineProperty(t,e,{get:function(){return this.__state.space==="RGB"?this.__state[e]:(O.recalculateRGB(this,e,n),this.__state[e])},set:function(r){this.__state.space!=="RGB"&&(O.recalculateRGB(this,e,n),this.__state.space="RGB"),this.__state[e]=r}})}function Ne(t,e){Object.defineProperty(t,e,{get:function(){return this.__state.space==="HSV"?this.__state[e]:(O.recalculateHSV(this),this.__state[e])},set:function(i){this.__state.space!=="HSV"&&(O.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=i}})}O.recalculateRGB=function(t,e,n){if(t.__state.space==="HEX")t.__state[e]=be.component_from_hex(t.__state.hex,n);else if(t.__state.space==="HSV")u.extend(t.__state,be.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v));else throw new Error("Corrupted color state")};O.recalculateHSV=function(t){var e=be.rgb_to_hsv(t.r,t.g,t.b);u.extend(t.__state,{s:e.s,v:e.v}),u.isNaN(e.h)?u.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=e.h};O.COMPONENTS=["r","g","b","h","s","v","hex","a"];Be(O.prototype,"r",2);Be(O.prototype,"g",1);Be(O.prototype,"b",0);Ne(O.prototype,"h");Ne(O.prototype,"s");Ne(O.prototype,"v");Object.defineProperty(O.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}});Object.defineProperty(O.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=be.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var K=function(){function t(e,n){V(this,t),this.initialValue=e[n],this.domElement=document.createElement("div"),this.object=e,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return U(t,[{key:"onChange",value:function(n){return this.__onChange=n,this}},{key:"onFinishChange",value:function(n){return this.__onFinishChange=n,this}},{key:"setValue",value:function(n){return this.object[this.property]=n,this.__onChange&&this.__onChange.call(this,n),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),t}(),wt={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},ot={};u.each(wt,function(t,e){u.each(t,function(n){ot[n]=e})});var At=/(\d+(\.\d+)?)px/;function z(t){if(t==="0"||u.isUndefined(t))return 0;var e=t.match(At);return u.isNull(e)?0:parseFloat(e[1])}var a={makeSelectable:function(e,n){e===void 0||e.style===void 0||(e.onselectstart=n?function(){return!1}:function(){},e.style.MozUserSelect=n?"auto":"none",e.style.KhtmlUserSelect=n?"auto":"none",e.unselectable=n?"on":"off")},makeFullscreen:function(e,n,i){var r=i,s=n;u.isUndefined(s)&&(s=!0),u.isUndefined(r)&&(r=!0),e.style.position="absolute",s&&(e.style.left=0,e.style.right=0),r&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,n,i,r){var s=i||{},o=ot[n];if(!o)throw new Error("Event type "+n+" not supported.");var d=document.createEvent(o);switch(o){case"MouseEvents":{var l=s.x||s.clientX||0,h=s.y||s.clientY||0;d.initMouseEvent(n,s.bubbles||!1,s.cancelable||!0,window,s.clickCount||1,0,0,l,h,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var m=d.initKeyboardEvent||d.initKeyEvent;u.defaults(s,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),m(n,s.bubbles||!1,s.cancelable,window,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.keyCode,s.charCode);break}default:{d.initEvent(n,s.bubbles||!1,s.cancelable||!0);break}}u.defaults(d,r),e.dispatchEvent(d)},bind:function(e,n,i,r){var s=r||!1;return e.addEventListener?e.addEventListener(n,i,s):e.attachEvent&&e.attachEvent("on"+n,i),a},unbind:function(e,n,i,r){var s=r||!1;return e.removeEventListener?e.removeEventListener(n,i,s):e.detachEvent&&e.detachEvent("on"+n,i),a},addClass:function(e,n){if(e.className===void 0)e.className=n;else if(e.className!==n){var i=e.className.split(/ +/);i.indexOf(n)===-1&&(i.push(n),e.className=i.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return a},removeClass:function(e,n){if(n)if(e.className===n)e.removeAttribute("class");else{var i=e.className.split(/ +/),r=i.indexOf(n);r!==-1&&(i.splice(r,1),e.className=i.join(" "))}else e.className=void 0;return a},hasClass:function(e,n){return new RegExp("(?:^|\\s+)"+n+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var n=getComputedStyle(e);return z(n["border-left-width"])+z(n["border-right-width"])+z(n["padding-left"])+z(n["padding-right"])+z(n.width)},getHeight:function(e){var n=getComputedStyle(e);return z(n["border-top-width"])+z(n["border-bottom-width"])+z(n["padding-top"])+z(n["padding-bottom"])+z(n.height)},getOffset:function(e){var n=e,i={left:0,top:0};if(n.offsetParent)do i.left+=n.offsetLeft,i.top+=n.offsetTop,n=n.offsetParent;while(n);return i},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},at=function(t){j(e,t);function e(n,i){V(this,e);var r=W(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,i)),s=r;r.__prev=r.getValue(),r.__checkbox=document.createElement("input"),r.__checkbox.setAttribute("type","checkbox");function o(){s.setValue(!s.__prev)}return a.bind(r.__checkbox,"change",o,!1),r.domElement.appendChild(r.__checkbox),r.updateDisplay(),r}return U(e,[{key:"setValue",value:function(i){var r=Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),r}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(K),St=function(t){j(e,t);function e(n,i,r){V(this,e);var s=W(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,i)),o=r,d=s;if(s.__select=document.createElement("select"),u.isArray(o)){var l={};u.each(o,function(h){l[h]=h}),o=l}return u.each(o,function(h,m){var c=document.createElement("option");c.innerHTML=m,c.setAttribute("value",h),d.__select.appendChild(c)}),s.updateDisplay(),a.bind(s.__select,"change",function(){var h=this.options[this.selectedIndex].value;d.setValue(h)}),s.domElement.appendChild(s.__select),s}return U(e,[{key:"setValue",value:function(i){var r=Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),r}},{key:"updateDisplay",value:function(){return a.isActive(this.__select)?this:(this.__select.value=this.getValue(),Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(K),Ct=function(t){j(e,t);function e(n,i){V(this,e);var r=W(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,i)),s=r;function o(){s.setValue(s.__input.value)}function d(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),a.bind(r.__input,"keyup",o),a.bind(r.__input,"change",o),a.bind(r.__input,"blur",d),a.bind(r.__input,"keydown",function(l){l.keyCode===13&&this.blur()}),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return U(e,[{key:"updateDisplay",value:function(){return a.isActive(this.__input)||(this.__input.value=this.getValue()),Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(K);function Ge(t){var e=t.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var dt=function(t){j(e,t);function e(n,i,r){V(this,e);var s=W(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,i)),o=r||{};return s.__min=o.min,s.__max=o.max,s.__step=o.step,u.isUndefined(s.__step)?s.initialValue===0?s.__impliedStep=1:s.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(s.initialValue))/Math.LN10))/10:s.__impliedStep=s.__step,s.__precision=Ge(s.__impliedStep),s}return U(e,[{key:"setValue",value:function(i){var r=i;return this.__min!==void 0&&r<this.__min?r=this.__min:this.__max!==void 0&&r>this.__max&&(r=this.__max),this.__step!==void 0&&r%this.__step!==0&&(r=Math.round(r/this.__step)*this.__step),Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r)}},{key:"min",value:function(i){return this.__min=i,this}},{key:"max",value:function(i){return this.__max=i,this}},{key:"step",value:function(i){return this.__step=i,this.__impliedStep=i,this.__precision=Ge(i),this}}]),e}(K);function Tt(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}var ge=function(t){j(e,t);function e(n,i,r){V(this,e);var s=W(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,i,r));s.__truncationSuspended=!1;var o=s,d=void 0;function l(){var v=parseFloat(o.__input.value);u.isNaN(v)||o.setValue(v)}function h(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function m(){h()}function c(v){var f=d-v.clientY;o.setValue(o.getValue()+f*o.__impliedStep),d=v.clientY}function _(){a.unbind(window,"mousemove",c),a.unbind(window,"mouseup",_),h()}function p(v){a.bind(window,"mousemove",c),a.bind(window,"mouseup",_),d=v.clientY}return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),a.bind(s.__input,"change",l),a.bind(s.__input,"blur",m),a.bind(s.__input,"mousedown",p),a.bind(s.__input,"keydown",function(v){v.keyCode===13&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,h())}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return U(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():Tt(this.getValue(),this.__precision),Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(dt);function Xe(t,e,n,i,r){return i+(r-i)*((t-e)/(n-e))}var Re=function(t){j(e,t);function e(n,i,r,s,o){V(this,e);var d=W(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,i,{min:r,max:s,step:o})),l=d;d.__background=document.createElement("div"),d.__foreground=document.createElement("div"),a.bind(d.__background,"mousedown",h),a.bind(d.__background,"touchstart",_),a.addClass(d.__background,"slider"),a.addClass(d.__foreground,"slider-fg");function h(f){document.activeElement.blur(),a.bind(window,"mousemove",m),a.bind(window,"mouseup",c),m(f)}function m(f){f.preventDefault();var b=l.__background.getBoundingClientRect();return l.setValue(Xe(f.clientX,b.left,b.right,l.__min,l.__max)),!1}function c(){a.unbind(window,"mousemove",m),a.unbind(window,"mouseup",c),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}function _(f){f.touches.length===1&&(a.bind(window,"touchmove",p),a.bind(window,"touchend",v),p(f))}function p(f){var b=f.touches[0].clientX,E=l.__background.getBoundingClientRect();l.setValue(Xe(b,E.left,E.right,l.__min,l.__max))}function v(){a.unbind(window,"touchmove",p),a.unbind(window,"touchend",v),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}return d.updateDisplay(),d.__background.appendChild(d.__foreground),d.domElement.appendChild(d.__background),d}return U(e,[{key:"updateDisplay",value:function(){var i=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=i*100+"%",Y(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(dt),lt=function(t){j(e,t);function e(n,i,r){V(this,e);var s=W(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,i)),o=s;return s.__button=document.createElement("div"),s.__button.innerHTML=r===void 0?"Fire":r,a.bind(s.__button,"click",function(d){return d.preventDefault(),o.fire(),!1}),a.addClass(s.__button,"button"),s.domElement.appendChild(s.__button),s}return U(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(K),Oe=function(t){j(e,t);function e(n,i){V(this,e);var r=W(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n,i));r.__color=new O(r.getValue()),r.__temp=new O(0);var s=r;r.domElement=document.createElement("div"),a.makeSelectable(r.domElement,!1),r.__selector=document.createElement("div"),r.__selector.className="selector",r.__saturation_field=document.createElement("div"),r.__saturation_field.className="saturation-field",r.__field_knob=document.createElement("div"),r.__field_knob.className="field-knob",r.__field_knob_border="2px solid ",r.__hue_knob=document.createElement("div"),r.__hue_knob.className="hue-knob",r.__hue_field=document.createElement("div"),r.__hue_field.className="hue-field",r.__input=document.createElement("input"),r.__input.type="text",r.__input_textShadow="0 1px 1px ",a.bind(r.__input,"keydown",function(f){f.keyCode===13&&c.call(this)}),a.bind(r.__input,"blur",c),a.bind(r.__selector,"mousedown",function(){a.addClass(this,"drag").bind(window,"mouseup",function(){a.removeClass(s.__selector,"drag")})}),a.bind(r.__selector,"touchstart",function(){a.addClass(this,"drag").bind(window,"touchend",function(){a.removeClass(s.__selector,"drag")})});var o=document.createElement("div");u.extend(r.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),u.extend(r.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:r.__field_knob_border+(r.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),u.extend(r.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),u.extend(r.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),u.extend(o.style,{width:"100%",height:"100%",background:"none"}),Ye(o,"top","rgba(0,0,0,0)","#000"),u.extend(r.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),Rt(r.__hue_field),u.extend(r.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:r.__input_textShadow+"rgba(0,0,0,0.7)"}),a.bind(r.__saturation_field,"mousedown",d),a.bind(r.__saturation_field,"touchstart",d),a.bind(r.__field_knob,"mousedown",d),a.bind(r.__field_knob,"touchstart",d),a.bind(r.__hue_field,"mousedown",l),a.bind(r.__hue_field,"touchstart",l);function d(f){p(f),a.bind(window,"mousemove",p),a.bind(window,"touchmove",p),a.bind(window,"mouseup",h),a.bind(window,"touchend",h)}function l(f){v(f),a.bind(window,"mousemove",v),a.bind(window,"touchmove",v),a.bind(window,"mouseup",m),a.bind(window,"touchend",m)}function h(){a.unbind(window,"mousemove",p),a.unbind(window,"touchmove",p),a.unbind(window,"mouseup",h),a.unbind(window,"touchend",h),_()}function m(){a.unbind(window,"mousemove",v),a.unbind(window,"touchmove",v),a.unbind(window,"mouseup",m),a.unbind(window,"touchend",m),_()}function c(){var f=ke(this.value);f!==!1?(s.__color.__state=f,s.setValue(s.__color.toOriginal())):this.value=s.__color.toString()}function _(){s.__onFinishChange&&s.__onFinishChange.call(s,s.__color.toOriginal())}r.__saturation_field.appendChild(o),r.__selector.appendChild(r.__field_knob),r.__selector.appendChild(r.__saturation_field),r.__selector.appendChild(r.__hue_field),r.__hue_field.appendChild(r.__hue_knob),r.domElement.appendChild(r.__input),r.domElement.appendChild(r.__selector),r.updateDisplay();function p(f){f.type.indexOf("touch")===-1&&f.preventDefault();var b=s.__saturation_field.getBoundingClientRect(),E=f.touches&&f.touches[0]||f,A=E.clientX,g=E.clientY,y=(A-b.left)/(b.right-b.left),x=1-(g-b.top)/(b.bottom-b.top);return x>1?x=1:x<0&&(x=0),y>1?y=1:y<0&&(y=0),s.__color.v=x,s.__color.s=y,s.setValue(s.__color.toOriginal()),!1}function v(f){f.type.indexOf("touch")===-1&&f.preventDefault();var b=s.__hue_field.getBoundingClientRect(),E=f.touches&&f.touches[0]||f,A=E.clientY,g=1-(A-b.top)/(b.bottom-b.top);return g>1?g=1:g<0&&(g=0),s.__color.h=g*360,s.setValue(s.__color.toOriginal()),!1}return r}return U(e,[{key:"updateDisplay",value:function(){var i=ke(this.getValue());if(i!==!1){var r=!1;u.each(O.COMPONENTS,function(d){if(!u.isUndefined(i[d])&&!u.isUndefined(this.__color.__state[d])&&i[d]!==this.__color.__state[d])return r=!0,{}},this),r&&u.extend(this.__color.__state,i)}u.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var s=this.__color.v<.5||this.__color.s>.5?255:0,o=255-s;u.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+s+","+s+","+s+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,Ye(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),u.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+s+","+s+","+s+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),e}(K),kt=["-moz-","-o-","-webkit-","-ms-",""];function Ye(t,e,n,i){t.style.background="",u.each(kt,function(r){t.style.cssText+="background: "+r+"linear-gradient("+e+", "+n+" 0%, "+i+" 100%); "})}function Rt(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var Ot={load:function(e,n){var i=n||document,r=i.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=e,i.getElementsByTagName("head")[0].appendChild(r)},inject:function(e,n){var i=n||document,r=document.createElement("style");r.type="text/css",r.innerHTML=e;var s=i.getElementsByTagName("head")[0];try{s.appendChild(r)}catch{}}},Mt=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,Pt=function(e,n){var i=e[n];return u.isArray(arguments[2])||u.isObject(arguments[2])?new St(e,n,arguments[2]):u.isNumber(i)?u.isNumber(arguments[2])&&u.isNumber(arguments[3])?u.isNumber(arguments[4])?new Re(e,n,arguments[2],arguments[3],arguments[4]):new Re(e,n,arguments[2],arguments[3]):u.isNumber(arguments[4])?new ge(e,n,{min:arguments[2],max:arguments[3],step:arguments[4]}):new ge(e,n,{min:arguments[2],max:arguments[3]}):u.isString(i)?new Ct(e,n):u.isFunction(i)?new lt(e,n,""):u.isBoolean(i)?new at(e,n):null};function Lt(t){setTimeout(t,1e3/60)}var Ft=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||Lt,Bt=function(){function t(){V(this,t),this.backgroundElement=document.createElement("div"),u.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),a.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),u.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;a.bind(this.backgroundElement,"click",function(){e.hide()})}return U(t,[{key:"show",value:function(){var n=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),u.defer(function(){n.backgroundElement.style.opacity=1,n.domElement.style.opacity=1,n.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var n=this,i=function r(){n.domElement.style.display="none",n.backgroundElement.style.display="none",a.unbind(n.domElement,"webkitTransitionEnd",r),a.unbind(n.domElement,"transitionend",r),a.unbind(n.domElement,"oTransitionEnd",r)};a.bind(this.domElement,"webkitTransitionEnd",i),a.bind(this.domElement,"transitionend",i),a.bind(this.domElement,"oTransitionEnd",i),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-a.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-a.getHeight(this.domElement)/2+"px"}}]),t}(),Nt=yt(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`);Ot.inject(Nt);var $e="dg",je=72,We=20,le="Default",se=function(){try{return!!window.localStorage}catch{return!1}}(),oe=void 0,Ke=!0,q=void 0,Ce=!1,ct=[],S=function t(e){var n=this,i=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),a.addClass(this.domElement,$e),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],i=u.defaults(i,{closeOnTop:!1,autoPlace:!0,width:t.DEFAULT_WIDTH}),i=u.defaults(i,{resizable:i.autoPlace,hideable:i.autoPlace}),u.isUndefined(i.load)?i.load={preset:le}:i.preset&&(i.load.preset=i.preset),u.isUndefined(i.parent)&&i.hideable&&ct.push(this),i.resizable=u.isUndefined(i.parent)&&i.resizable,i.autoPlace&&u.isUndefined(i.scrollable)&&(i.scrollable=!0);var r=se&&localStorage.getItem(Q(this,"isLocal"))==="true",s=void 0,o=void 0;if(Object.defineProperties(this,{parent:{get:function(){return i.parent}},scrollable:{get:function(){return i.scrollable}},autoPlace:{get:function(){return i.autoPlace}},closeOnTop:{get:function(){return i.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:i.load.preset},set:function(_){n.parent?n.getRoot().preset=_:i.load.preset=_,Vt(this),n.revert()}},width:{get:function(){return i.width},set:function(_){i.width=_,Le(n,_)}},name:{get:function(){return i.name},set:function(_){i.name=_,o&&(o.innerHTML=i.name)}},closed:{get:function(){return i.closed},set:function(_){i.closed=_,i.closed?a.addClass(n.__ul,t.CLASS_CLOSED):a.removeClass(n.__ul,t.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=_?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return i.load}},useLocalStorage:{get:function(){return r},set:function(_){se&&(r=_,_?a.bind(window,"unload",s):a.unbind(window,"unload",s),localStorage.setItem(Q(n,"isLocal"),_))}}}),u.isUndefined(i.parent)){if(this.closed=i.closed||!1,a.addClass(this.domElement,t.CLASS_MAIN),a.makeSelectable(this.domElement,!1),se&&r){n.useLocalStorage=!0;var d=localStorage.getItem(Q(this,"gui"));d&&(i.load=JSON.parse(d))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=t.TEXT_CLOSED,a.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON),i.closeOnTop?(a.addClass(this.__closeButton,t.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(a.addClass(this.__closeButton,t.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),a.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{i.closed===void 0&&(i.closed=!0);var l=document.createTextNode(i.name);a.addClass(l,"controller-name"),o=De(n,l);var h=function(_){return _.preventDefault(),n.closed=!n.closed,!1};a.addClass(this.__ul,t.CLASS_CLOSED),a.addClass(o,"title"),a.bind(o,"click",h),i.closed||(this.closed=!1)}i.autoPlace&&(u.isUndefined(i.parent)&&(Ke&&(q=document.createElement("div"),a.addClass(q,$e),a.addClass(q,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(q),Ke=!1),q.appendChild(this.domElement),a.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||Le(n,i.width)),this.__resizeHandler=function(){n.onResizeDebounced()},a.bind(window,"resize",this.__resizeHandler),a.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),a.bind(this.__ul,"transitionend",this.__resizeHandler),a.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),i.resizable&&Ht(this),s=function(){se&&localStorage.getItem(Q(n,"isLocal"))==="true"&&localStorage.setItem(Q(n,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=s;function m(){var c=n.getRoot();c.width+=1,u.defer(function(){c.width-=1})}i.parent||m()};S.toggleHide=function(){Ce=!Ce,u.each(ct,function(t){t.domElement.style.display=Ce?"none":""})};S.CLASS_AUTO_PLACE="a";S.CLASS_AUTO_PLACE_CONTAINER="ac";S.CLASS_MAIN="main";S.CLASS_CONTROLLER_ROW="cr";S.CLASS_TOO_TALL="taller-than-window";S.CLASS_CLOSED="closed";S.CLASS_CLOSE_BUTTON="close-button";S.CLASS_CLOSE_TOP="close-top";S.CLASS_CLOSE_BOTTOM="close-bottom";S.CLASS_DRAG="drag";S.DEFAULT_WIDTH=245;S.TEXT_CLOSED="Close Controls";S.TEXT_OPEN="Open Controls";S._keydownHandler=function(t){document.activeElement.type!=="text"&&(t.which===je||t.keyCode===je)&&S.toggleHide()};a.bind(window,"keydown",S._keydownHandler,!1);u.extend(S.prototype,{add:function(e,n){return ae(this,e,n,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,n){return ae(this,e,n,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var n=this;u.defer(function(){n.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&q.removeChild(this.domElement);var e=this;u.each(this.__folders,function(n){e.removeFolder(n)}),a.unbind(window,"keydown",S._keydownHandler,!1),Je(this)},addFolder:function(e){if(this.__folders[e]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+e+'"');var n={name:e,parent:this};n.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(n.closed=this.load.folders[e].closed,n.load=this.load.folders[e]);var i=new S(n);this.__folders[e]=i;var r=De(this,i.domElement);return a.addClass(r,"folder"),i},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],Je(e);var n=this;u.each(e.__folders,function(i){e.removeFolder(i)}),u.defer(function(){n.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var n=a.getOffset(e.__ul).top,i=0;u.each(e.__ul.childNodes,function(r){e.autoPlace&&r===e.__save_row||(i+=a.getHeight(r))}),window.innerHeight-n-We<i?(a.addClass(e.domElement,S.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-n-We+"px"):(a.removeClass(e.domElement,S.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&u.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:u.debounce(function(){this.onResize()},50),remember:function(){if(u.isUndefined(oe)&&(oe=new Bt,oe.domElement.innerHTML=Mt),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;u.each(Array.prototype.slice.call(arguments),function(n){e.__rememberedObjects.length===0&&It(e),e.__rememberedObjects.indexOf(n)===-1&&e.__rememberedObjects.push(n)}),this.autoPlace&&Le(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=_e(this)),e.folders={},u.each(this.__folders,function(n,i){e.folders[i]=n.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=_e(this),Me(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[le]=_e(this,!0)),this.load.remembered[e]=_e(this),this.preset=e,Pe(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){u.each(this.__controllers,function(n){this.getRoot().load.remembered?ut(e||this.getRoot(),n):n.setValue(n.initialValue),n.__onFinishChange&&n.__onFinishChange.call(n,n.getValue())},this),u.each(this.__folders,function(n){n.revert(n)}),e||Me(this.getRoot(),!1)},listen:function(e){var n=this.__listening.length===0;this.__listening.push(e),n&&ht(this.__listening)},updateDisplay:function(){u.each(this.__controllers,function(e){e.updateDisplay()}),u.each(this.__folders,function(e){e.updateDisplay()})}});function De(t,e,n){var i=document.createElement("li");return e&&i.appendChild(e),n?t.__ul.insertBefore(i,n):t.__ul.appendChild(i),t.onResize(),i}function Je(t){a.unbind(window,"resize",t.__resizeHandler),t.saveToLocalStorageIfPossible&&a.unbind(window,"unload",t.saveToLocalStorageIfPossible)}function Me(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];e?n.innerHTML=n.value+"*":n.innerHTML=n.value}function Dt(t,e,n){if(n.__li=e,n.__gui=t,u.extend(n,{options:function(o){if(arguments.length>1){var d=n.__li.nextElementSibling;return n.remove(),ae(t,n.object,n.property,{before:d,factoryArgs:[u.toArray(arguments)]})}if(u.isArray(o)||u.isObject(o)){var l=n.__li.nextElementSibling;return n.remove(),ae(t,n.object,n.property,{before:l,factoryArgs:[o]})}},name:function(o){return n.__li.firstElementChild.firstElementChild.innerHTML=o,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof Re){var i=new ge(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});u.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(s){var o=n[s],d=i[s];n[s]=i[s]=function(){var l=Array.prototype.slice.call(arguments);return d.apply(i,l),o.apply(n,l)}}),a.addClass(e,"has-slider"),n.domElement.insertBefore(i.domElement,n.domElement.firstElementChild)}else if(n instanceof ge){var r=function(o){if(u.isNumber(n.__min)&&u.isNumber(n.__max)){var d=n.__li.firstElementChild.firstElementChild.innerHTML,l=n.__gui.__listening.indexOf(n)>-1;n.remove();var h=ae(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return h.name(d),l&&h.listen(),h}return o};n.min=u.compose(r,n.min),n.max=u.compose(r,n.max)}else n instanceof at?(a.bind(e,"click",function(){a.fakeEvent(n.__checkbox,"click")}),a.bind(n.__checkbox,"click",function(s){s.stopPropagation()})):n instanceof lt?(a.bind(e,"click",function(){a.fakeEvent(n.__button,"click")}),a.bind(e,"mouseover",function(){a.addClass(n.__button,"hover")}),a.bind(e,"mouseout",function(){a.removeClass(n.__button,"hover")})):n instanceof Oe&&(a.addClass(e,"color"),n.updateDisplay=u.compose(function(s){return e.style.borderLeftColor=n.__color.toString(),s},n.updateDisplay),n.updateDisplay());n.setValue=u.compose(function(s){return t.getRoot().__preset_select&&n.isModified()&&Me(t.getRoot(),!0),s},n.setValue)}function ut(t,e){var n=t.getRoot(),i=n.__rememberedObjects.indexOf(e.object);if(i!==-1){var r=n.__rememberedObjectIndecesToControllers[i];if(r===void 0&&(r={},n.__rememberedObjectIndecesToControllers[i]=r),r[e.property]=e,n.load&&n.load.remembered){var s=n.load.remembered,o=void 0;if(s[t.preset])o=s[t.preset];else if(s[le])o=s[le];else return;if(o[i]&&o[i][e.property]!==void 0){var d=o[i][e.property];e.initialValue=d,e.setValue(d)}}}}function ae(t,e,n,i){if(e[n]===void 0)throw new Error('Object "'+e+'" has no property "'+n+'"');var r=void 0;if(i.color)r=new Oe(e,n);else{var s=[e,n].concat(i.factoryArgs);r=Pt.apply(t,s)}i.before instanceof K&&(i.before=i.before.__li),ut(t,r),a.addClass(r.domElement,"c");var o=document.createElement("span");a.addClass(o,"property-name"),o.innerHTML=r.property;var d=document.createElement("div");d.appendChild(o),d.appendChild(r.domElement);var l=De(t,d,i.before);return a.addClass(l,S.CLASS_CONTROLLER_ROW),r instanceof Oe?a.addClass(l,"color"):a.addClass(l,xt(r.getValue())),Dt(t,l,r),t.__controllers.push(r),r}function Q(t,e){return document.location.href+"."+e}function Pe(t,e,n){var i=document.createElement("option");i.innerHTML=e,i.value=e,t.__preset_select.appendChild(i),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function qe(t,e){e.style.display=t.useLocalStorage?"block":"none"}function It(t){var e=t.__save_row=document.createElement("li");a.addClass(t.domElement,"has-save"),t.__ul.insertBefore(e,t.__ul.firstChild),a.addClass(e,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",a.addClass(n,"button gears");var i=document.createElement("span");i.innerHTML="Save",a.addClass(i,"button"),a.addClass(i,"save");var r=document.createElement("span");r.innerHTML="New",a.addClass(r,"button"),a.addClass(r,"save-as");var s=document.createElement("span");s.innerHTML="Revert",a.addClass(s,"button"),a.addClass(s,"revert");var o=t.__preset_select=document.createElement("select");if(t.load&&t.load.remembered?u.each(t.load.remembered,function(c,_){Pe(t,_,_===t.preset)}):Pe(t,le,!1),a.bind(o,"change",function(){for(var c=0;c<t.__preset_select.length;c++)t.__preset_select[c].innerHTML=t.__preset_select[c].value;t.preset=this.value}),e.appendChild(o),e.appendChild(n),e.appendChild(i),e.appendChild(r),e.appendChild(s),se){var d=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage"),h=document.getElementById("dg-save-locally");h.style.display="block",localStorage.getItem(Q(t,"isLocal"))==="true"&&l.setAttribute("checked","checked"),qe(t,d),a.bind(l,"change",function(){t.useLocalStorage=!t.useLocalStorage,qe(t,d)})}var m=document.getElementById("dg-new-constructor");a.bind(m,"keydown",function(c){c.metaKey&&(c.which===67||c.keyCode===67)&&oe.hide()}),a.bind(n,"click",function(){m.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),oe.show(),m.focus(),m.select()}),a.bind(i,"click",function(){t.save()}),a.bind(r,"click",function(){var c=prompt("Enter a new preset name.");c&&t.saveAs(c)}),a.bind(s,"click",function(){t.revert()})}function Ht(t){var e=void 0;t.__resize_handle=document.createElement("div"),u.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function n(s){return s.preventDefault(),t.width+=e-s.clientX,t.onResize(),e=s.clientX,!1}function i(){a.removeClass(t.__closeButton,S.CLASS_DRAG),a.unbind(window,"mousemove",n),a.unbind(window,"mouseup",i)}function r(s){return s.preventDefault(),e=s.clientX,a.addClass(t.__closeButton,S.CLASS_DRAG),a.bind(window,"mousemove",n),a.bind(window,"mouseup",i),!1}a.bind(t.__resize_handle,"mousedown",r),a.bind(t.__closeButton,"mousedown",r),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function Le(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function _e(t,e){var n={};return u.each(t.__rememberedObjects,function(i,r){var s={},o=t.__rememberedObjectIndecesToControllers[r];u.each(o,function(d,l){s[l]=e?d.initialValue:d.getValue()}),n[r]=s}),n}function Vt(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value===t.preset&&(t.__preset_select.selectedIndex=e)}function ht(t){t.length!==0&&Ft.call(window,function(){ht(t)}),u.each(t,function(e){e.updateDisplay()})}var Ut=S;const P=new Uint8Array(32*32),ye=new Uint8Array(256*256*2);function Qe(){const t=new Uint8Array(1024);for(let e=1;e<31;e++)for(let n=1;n<31;n++){let i=P[e*32+n]*4;i+=P[(e-1)*32+n],i+=P[(e+1)*32+n],i+=P[e*32+(n-1)],i+=P[e*32+(n+1)],i/=8,t[e*32+n]=i}for(let e=1;e<31;e++)for(let n=1;n<31;n++)P[e*32+n]=t[e*32+n]}function zt(){for(let t=2;t<30;t++)for(let e=2;e<30;e++){let n=1;for(;n<=32&&Math.random()<.5;){const i=Math.min(255,P[t*32+e]+n);P[t*32+e]=i,n+=n}for(n=1;n<=32&&Math.random()<.5;){const i=Math.max(0,P[t*32+e]-n);P[t*32+e]=i,n+=n}}}let Ze=!0;function Gt(){for(let t=0;t<32;t++)for(let e=0;e<32;e++){const n=Math.sqrt((t-15.5)*(t-15.5)+(e-15.5)*(e-15.5));let i=0;n<=15&&(i=255*Math.cos(n*Math.PI/31)),Ze||(i=Math.min(255,(i+P[t*32+e]+P[t*32+e])/3)),P[t*32+e]=i}Ze=!1,zt(),Qe(),Qe()}function Xt(t,e){for(let n=0;n<32;n++)for(let i=0;i<32;i++)ye[(n+t)*256*2+(i+e)*2]=P[n*32+i],ye[(n+t)*256*2+(i+e)*2+1]=P[n*32+i]}function Yt(){for(let t=0;t<32;t++)for(let e=0;e<32;e++){const n=(P[t*32+e]+ye[t*256*2+e*2])/2;P[t*32+e]=Math.min(255,n)}}function $t(){for(let t=0;t<8;t++)for(let e=0;e<8;e++)t===7&&e===7?Yt():Gt(),Xt(t*32,e*32)}$t();function jt(t){const e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE_ALPHA,256,256,0,t.LUMINANCE_ALPHA,t.UNSIGNED_BYTE,ye),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST),t.generateMipmap(t.TEXTURE_2D),e}const Wt=`
attribute vec3 a_position;
attribute vec4 a_color;
attribute vec2 a_texCoord;

uniform mat4 u_mvpMatrix;

varying vec2 v_texCoord;
varying vec4 v_color;

void main() {
    gl_Position = u_mvpMatrix * vec4(a_position, 1.0);

    v_texCoord = a_texCoord;
    v_color = a_color;
}
`,Kt=`
precision mediump float;

uniform sampler2D u_image;

varying vec2 v_texCoord;
varying vec4 v_color;

void main() {
    float alpha = texture2D(u_image, v_texCoord).a;
    gl_FragColor = vec4(1.0, 1.0, 1.0, alpha) * v_color;
}
`;function et(t,e,n){const i=t.createShader(n);return t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:(console.error("An error occurred compiling the shaders: "+t.getShaderInfoLog(i)),t.deleteShader(i),null)}function Jt(t){const e=et(t,Wt,t.VERTEX_SHADER),n=et(t,Kt,t.FRAGMENT_SHADER),i=t.createProgram();t.attachShader(i,e),t.attachShader(i,n),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||console.error("Unable to initialize the shader program: "+t.getProgramInfoLog(i)),t.useProgram(i);const r={mvpMatrix:t.getUniformLocation(i,"u_mvpMatrix"),image:t.getUniformLocation(i,"u_image")},s={position:t.getAttribLocation(i,"a_position"),color:t.getAttribLocation(i,"a_color"),texCoord:t.getAttribLocation(i,"a_texCoord")};return{program:i,uniforms:r,attribs:s}}var ve=1e-6,ce=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function T(){var t=new ce(16);return ce!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function qt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Qt(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],d=e[5],l=e[6],h=e[7],m=e[8],c=e[9],_=e[10],p=e[11],v=e[12],f=e[13],b=e[14],E=e[15],A=n*d-i*o,g=n*l-r*o,y=n*h-s*o,x=i*l-r*d,w=i*h-s*d,F=r*h-s*l,B=m*f-c*v,k=m*b-_*v,R=m*E-p*v,N=c*b-_*f,D=c*E-p*f,G=_*E-p*b,C=A*G-g*D+y*N+x*R-w*k+F*B;return C?(C=1/C,t[0]=(d*G-l*D+h*N)*C,t[1]=(r*D-i*G-s*N)*C,t[2]=(f*F-b*w+E*x)*C,t[3]=(_*w-c*F-p*x)*C,t[4]=(l*R-o*G-h*k)*C,t[5]=(n*G-r*R+s*k)*C,t[6]=(b*y-v*F-E*g)*C,t[7]=(m*F-_*y+p*g)*C,t[8]=(o*D-d*R+h*B)*C,t[9]=(i*R-n*D-s*B)*C,t[10]=(v*w-f*y+E*A)*C,t[11]=(c*y-m*w-p*A)*C,t[12]=(d*k-o*N-l*B)*C,t[13]=(n*N-i*k+r*B)*C,t[14]=(f*g-v*x-b*A)*C,t[15]=(m*x-c*g+_*A)*C,t):null}function H(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],d=e[4],l=e[5],h=e[6],m=e[7],c=e[8],_=e[9],p=e[10],v=e[11],f=e[12],b=e[13],E=e[14],A=e[15],g=n[0],y=n[1],x=n[2],w=n[3];return t[0]=g*i+y*d+x*c+w*f,t[1]=g*r+y*l+x*_+w*b,t[2]=g*s+y*h+x*p+w*E,t[3]=g*o+y*m+x*v+w*A,g=n[4],y=n[5],x=n[6],w=n[7],t[4]=g*i+y*d+x*c+w*f,t[5]=g*r+y*l+x*_+w*b,t[6]=g*s+y*h+x*p+w*E,t[7]=g*o+y*m+x*v+w*A,g=n[8],y=n[9],x=n[10],w=n[11],t[8]=g*i+y*d+x*c+w*f,t[9]=g*r+y*l+x*_+w*b,t[10]=g*s+y*h+x*p+w*E,t[11]=g*o+y*m+x*v+w*A,g=n[12],y=n[13],x=n[14],w=n[15],t[12]=g*i+y*d+x*c+w*f,t[13]=g*r+y*l+x*_+w*b,t[14]=g*s+y*h+x*p+w*E,t[15]=g*o+y*m+x*v+w*A,t}function ft(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function _t(t,e,n){var i=n[0],r=n[1],s=n[2],o=Math.hypot(i,r,s),d,l,h;return o<ve?null:(o=1/o,i*=o,r*=o,s*=o,d=Math.sin(e),l=Math.cos(e),h=1-l,t[0]=i*i*h+l,t[1]=r*i*h+s*d,t[2]=s*i*h-r*d,t[3]=0,t[4]=i*r*h-s*d,t[5]=r*r*h+l,t[6]=s*r*h+i*d,t[7]=0,t[8]=i*s*h+r*d,t[9]=r*s*h-i*d,t[10]=s*s*h+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function pt(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function mt(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ee(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Zt(t,e,n,i,r){var s=1/Math.tan(e/2);if(t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,r!=null&&r!==1/0){var o=1/(i-r);t[10]=(r+i)*o,t[14]=2*r*i*o}else t[10]=-1,t[14]=-2*i;return t}var en=Zt;function tn(t,e,n,i,r,s,o){var d=1/(e-n),l=1/(i-r),h=1/(s-o);return t[0]=-2*d,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+n)*d,t[13]=(r+i)*l,t[14]=(o+s)*h,t[15]=1,t}var nn=tn;function rn(t,e,n,i){var r,s,o,d,l,h,m,c,_,p,v=e[0],f=e[1],b=e[2],E=i[0],A=i[1],g=i[2],y=n[0],x=n[1],w=n[2];return Math.abs(v-y)<ve&&Math.abs(f-x)<ve&&Math.abs(b-w)<ve?qt(t):(m=v-y,c=f-x,_=b-w,p=1/Math.hypot(m,c,_),m*=p,c*=p,_*=p,r=A*_-g*c,s=g*m-E*_,o=E*c-A*m,p=Math.hypot(r,s,o),p?(p=1/p,r*=p,s*=p,o*=p):(r=0,s=0,o=0),d=c*o-_*s,l=_*r-m*o,h=m*s-c*r,p=Math.hypot(d,l,h),p?(p=1/p,d*=p,l*=p,h*=p):(d=0,l=0,h=0),t[0]=r,t[1]=d,t[2]=m,t[3]=0,t[4]=s,t[5]=l,t[6]=c,t[7]=0,t[8]=o,t[9]=h,t[10]=_,t[11]=0,t[12]=-(r*v+s*f+o*b),t[13]=-(d*v+l*f+h*b),t[14]=-(m*v+c*f+_*b),t[15]=1,t)}function sn(){var t=new ce(3);return ce!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function M(t,e,n){var i=new ce(3);return i[0]=t,i[1]=e,i[2]=n,i}function tt(t,e){var n=e[0],i=e[1],r=e[2],s=n*n+i*i+r*r;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function L(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[3]*i+n[7]*r+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*i+n[4]*r+n[8]*s+n[12])/o,t[1]=(n[1]*i+n[5]*r+n[9]*s+n[13])/o,t[2]=(n[2]*i+n[6]*r+n[10]*s+n[14])/o,t}(function(){var t=sn();return function(e,n,i,r,s,o){var d,l;for(n||(n=3),i||(i=0),r?l=Math.min(r*n+i,e.length):l=e.length,d=i;d<l;d+=n)t[0]=e[d],t[1]=e[d+1],t[2]=e[d+2],s(t,t,o),e[d]=t[0],e[d+1]=t[1],e[d+2]=t[2];return e}})();function X(t,e){return Math.random()*(e-t)+t}function ie(t){return(1-(Math.random()+Math.random()+Math.random())/1.5)*t}const ee=1800,vt=16384;class on{constructor(){this.position=[0,0,0],this.rotSpeed=0,this.mystery=0,this.shader=null,this.vertexBuffer=null,this.texture=null}init(e,n,i){for(let r=0;r<3;r++)this.position[r]=X(-100,100);this.rotSpeed=X(.4,.9),this.mystery=X(0,10),this.shader=n,this.texture=i,this.initBuffers(e)}initBuffers(e){const n=[];for(let r=0;r<30;r++){const s=3+Math.random()*150,o=M(-3,0,0),d=M(0,s,0),l=M(3,0,0),h=T(),m=Math.random()*360*Math.PI/180;_t(h,m,[0,0,1]);const c=M(0,0,0),_=M(0,0,0),p=M(0,0,0);L(c,o,h),L(_,d,h),L(p,l,h);const v=X(.125,1),f=X(.125,1),b=X(.125,1);n.push(c[0],c[1],c[2],v,f,b,0,0,_[0],_[1],_[2],v,f,b,.5,1,p[0],p[1],p[2],v,f,b,1,0)}this.vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW)}draw(e,n){e.useProgram(this.shader.program);const i=T();ft(i,this.position);const r=T();H(r,n.view,i);const s=T();H(s,n.projection,r),e.uniformMatrix4fv(this.shader.uniforms.mvpMatrix,!1,s),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.texture),e.uniform1i(this.shader.uniforms.image,0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.vertexAttribPointer(this.shader.attribs.position,3,e.FLOAT,!1,Float32Array.BYTES_PER_ELEMENT*8,0),e.vertexAttribPointer(this.shader.attribs.color,3,e.FLOAT,!1,Float32Array.BYTES_PER_ELEMENT*8,Float32Array.BYTES_PER_ELEMENT*3),e.vertexAttribPointer(this.shader.attribs.texCoord,2,e.FLOAT,!1,Float32Array.BYTES_PER_ELEMENT*8,Float32Array.BYTES_PER_ELEMENT*6),e.enableVertexAttribArray(this.shader.attribs.position),e.enableVertexAttribArray(this.shader.attribs.color),e.enableVertexAttribArray(this.shader.attribs.texCoord),e.drawArrays(e.TRIANGLES,0,3*30)}update(e,n){const i=2*Math.PI*12/vt*this.rotSpeed,r=n*i;let s=(Math.cos(7*r)+Math.cos(3*r)+Math.cos(13*r))/6+.75;const o=2*Math.PI*this.mystery/ee,d=250*s*Math.cos(11*(o+3*r)),l=250*s*Math.sin(12*(o+4*r)),h=250*Math.cos(23*(o+12*r)),m=r*.501+5.01*this.mystery/ee,c=r*2.501+85.01*this.mystery/ee,_=Ee(T(),m),p=mt(T(),m),v=pt(T(),m),f=Ee(T(),c),b=T();H(b,_,p),H(b,b,v),H(b,b,f);const E=M(d,l,h);L(E,E,b),this.position[0]=E[0],this.position[1]=E[1],this.position[2]=E[2]}}const an=12,Te=1e3;class dn{constructor(e){this.position=[0,0,0],this.color=[0,0,0,0],this.mystery=e,this.shader=null,this.vertexBuffer=null,this.texture=null}init(e,n,i){for(let r=0;r<3;r++)this.position[r]=X(-100,200);this.shader=n,this.texture=i,this.initBuffers(e)}initBuffers(e){const n=[];for(let r=0;r<12;r++){const s=2+Math.random()*15,o=M(-3,0,0),d=M(0,s,0),l=M(3,0,0),h=T(),m=Math.random()*360*Math.PI/180;_t(h,m,[0,0,1]);const c=M(0,0,0),_=M(0,0,0),p=M(0,0,0);L(c,o,h),L(_,d,h),L(p,l,h),n.push(c[0],c[1],c[2],1,1,1,0,0,_[0],_[1],_[2],1,1,1,.5,1,p[0],p[1],p[2],1,1,1,1,0)}this.vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW)}draw(e,n){e.useProgram(this.shader.program);const i=T();ft(i,this.position);const r=T();H(r,n.view,i);const s=T();H(s,n.projection,r),e.uniformMatrix4fv(this.shader.uniforms.mvpMatrix,!1,s),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.texture),e.uniform1i(this.shader.uniforms.image,0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.vertexAttribPointer(this.shader.attribs.position,3,e.FLOAT,!1,Float32Array.BYTES_PER_ELEMENT*8,0),e.vertexAttribPointer(this.shader.attribs.color,3,e.FLOAT,!1,Float32Array.BYTES_PER_ELEMENT*8,Float32Array.BYTES_PER_ELEMENT*3),e.vertexAttribPointer(this.shader.attribs.texCoord,2,e.FLOAT,!1,Float32Array.BYTES_PER_ELEMENT*8,Float32Array.BYTES_PER_ELEMENT*6),e.enableVertexAttribArray(this.shader.attribs.position),e.enableVertexAttribArray(this.shader.attribs.color),e.enableVertexAttribArray(this.shader.attribs.texCoord),e.drawArrays(e.TRIANGLES,0,3*12)}update(e,n){const i=2*Math.PI*an/vt,r=n*i,s=20,o=2*Math.PI/s,d=0,l=s/3,h=2*s/3,m=n,c=.109375*(Math.cos((m+d)*o)+1),_=.109375*(Math.cos((m+l)*o)+1),p=.109375*(Math.cos((m+h)*o)+1),v=(Math.cos(7*(n*i))+Math.cos(3*(n*i))+Math.cos(13*(n*i)))/6+2,f=2*Math.PI*this.mystery/ee;this.color[0]=c+.0625*(.5+Math.cos(15*(f+3*r))+Math.sin(7*(f+r))),this.color[1]=_+.0625*(.5+Math.sin(f+r)),this.color[2]=p+.0625*(.5+Math.cos(37*(f+r)));const b=Te*v*Math.cos(11*(f+3*r)),E=Te*v*Math.sin(12*(f+4*r)),A=Te*Math.cos(23*(f+12*r)),g=r*.501+5.01*this.mystery/ee,y=r*2.501+85.01*this.mystery/ee,x=Ee(T(),g),w=mt(T(),g),F=pt(T(),g),B=Ee(T(),y),k=T();H(k,x,w),H(k,k,F),H(k,k,B);const R=M(b,E,A);L(R,R,k),this.position[0]=R[0],this.position[1]=R[1],this.position[2]=R[2]}}const pe=3600,ln=.07,cn=450,nt=25e3,me=.15,it=8e3,un=15e5;class hn{constructor(){this.color=[0,0,0,0],this.position=[0,0,0],this.oldPosition=[0,0,0],this.delta=[0,0,0],this.dead=!1,this.startTime=0,this.liveTime=0,this.animFrame=0}}class fn{constructor(e,n,i){this.star=e,this.sparks=n,this.numStreams=i,this.drag=.999,this.p=[],this.n=0,this.sub=0,this.lastParticleTime=0,this.firstTime=!0,this.frame=0,this.old=[0,0,0],this.shader=null,this.vertexBuffer=null,this.texture=null}init(e,n,i){this.n=0,this.sub=0,this.lastParticleTime=.25,this.firstTime=1,this.frame=0;for(let r=0;r<3;r++)this.old[r]=X(-100,100);for(let r=0;r<pe;r++){const s=new hn;s.dead=!0,this.p.push(s)}this.shader=n,this.texture=i,this.initBuffers(e)}initBuffers(e){this.vertexBuffer=e.createBuffer()}draw(e,n){e.useProgram(this.shader.program);const i=T();H(i,n.projection,n.view),e.uniformMatrix4fv(this.shader.uniforms.mvpMatrix,!1,i),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.texture),e.uniform1i(this.shader.uniforms.image,0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer);const r=this.prepareBufferData(e,n);e.vertexAttribPointer(this.shader.attribs.position,3,e.FLOAT,!1,Float32Array.BYTES_PER_ELEMENT*9,0),e.vertexAttribPointer(this.shader.attribs.color,4,e.FLOAT,!1,Float32Array.BYTES_PER_ELEMENT*9,Float32Array.BYTES_PER_ELEMENT*3),e.vertexAttribPointer(this.shader.attribs.texCoord,2,e.FLOAT,!1,Float32Array.BYTES_PER_ELEMENT*9,Float32Array.BYTES_PER_ELEMENT*7),e.enableVertexAttribArray(this.shader.attribs.position),e.enableVertexAttribArray(this.shader.attribs.color),e.enableVertexAttribArray(this.shader.attribs.texCoord),e.drawArrays(e.TRIANGLES,0,r)}prepareBufferData(e,n){const i=[],r=(nt+2.5*it)*n.width/n.height;let s=0;for(let o=0;o<pe;o+=4)for(let d=0;d<4;d++){const l=this.p[o+d];if(l.dead)continue;const h=(nt+l.liveTime*it)*n.width/n.height;if(h>r){l.dead=!0;continue}const m=l.delta[0],c=l.delta[1],_=l.delta[2],v=20+Math.sqrt(m*m+c*c+_*_)/50,f=[0,0,0];L(f,l.position,n.view);const b=[0,0,0];L(b,[m,c,_],n.view),b[2]=0,tt(b,b);const E=[-b[1],b[0],0];tt(E,E);const A=4,g=[f[0]+b[0]*v,f[1]+b[1]*v,f[2]+b[2]*v],y=[f[0]+E[0]*v,f[1]+E[1]*v,f[2]+E[2]*v],x=[f[0]-E[0]*v,f[1]-E[1]*v,f[2]-E[2]*v],w=[f[0]-b[0]*v*A,f[1]-b[1]*v*A,f[2]-b[2]*v*A],F=T();Qt(F,n.view),L(g,g,F),L(y,y,F),L(x,x,F),L(w,w,F);const B=1.375-h/r,k=l.color[0]*B,R=l.color[1]*B,N=l.color[2]*B,D=l.color[3]*B,G=l.animFrame,C=(G&7)/8,he=(G>>3)/8,Ae=C+1/8,Se=he+1/8;i.push(g[0],g[1],g[2],k,R,N,D,C,he),i.push(y[0],y[1],y[2],k,R,N,D,C,Se),i.push(x[0],x[1],x[2],k,R,N,D,Ae,he),i.push(x[0],x[1],x[2],k,R,N,D,Ae,he),i.push(y[0],y[1],y[2],k,R,N,D,C,Se),i.push(w[0],w[1],w[2],k,R,N,D,Ae,Se),s+=6}return e.bufferData(e.ARRAY_BUFFER,new Float32Array(i),e.STREAM_DRAW),s}update(e,n){let i,r,s,o=this.star.position[0],d=this.star.position[1],l=this.star.position[2],h,m;if(this.frame++,this.firstTime)this.lastParticleTime=n,this.firstTime=!1;else for(;n-this.lastParticleTime>=1/121;){let c,_,p,v,f,b,E,A,g;for(c=this.old[0]-o,_=this.old[1]-d,p=this.old[2]-l,g=5,v=c*g,f=_*g,b=p*g,i=0;i<this.numStreams;i++){let y;this.p[this.n+this.sub].delta[0]=v,this.p[this.n+this.sub].delta[1]=f,this.p[this.n+this.sub].delta[2]=b,this.p[this.n+this.sub].position[0]=o,this.p[this.n+this.sub].position[1]=d,this.p[this.n+this.sub].position[2]=l,this.p[this.n+this.sub].oldPosition[0]=o,this.p[this.n+this.sub].oldPosition[1]=d,this.p[this.n+this.sub].oldPosition[2]=l,y=Math.max(0,1+ie(.25*ln)),c=o-this.sparks[i].position[0],_=d-this.sparks[i].position[1],p=l-this.sparks[i].position[2],A=c*c+_*_+p*p,E=cn*y,g=E/Math.sqrt(A),this.p[this.n+this.sub].delta[0]-=c*g,this.p[this.n+this.sub].delta[1]-=_*g,this.p[this.n+this.sub].delta[2]-=p*g,this.p[this.n+this.sub].color[0]=this.sparks[i].color[0]*(1+ie(me)),this.p[this.n+this.sub].color[1]=this.sparks[i].color[1]*(1+ie(me)),this.p[this.n+this.sub].color[2]=this.sparks[i].color[2]*(1+ie(me)),this.p[this.n+this.sub].color[3]=.85*(1+ie(me)),this.p[this.n+this.sub].startTime=n,this.p[this.n+this.sub].dead=!1,this.p[this.n+this.sub].animFrame=Math.floor(Math.random()*64),this.sub++,this.sub===4&&(this.n+=4,this.sub=0),this.n>=pe&&(this.n=0,this.sub=0)}this.lastParticleTime+=1/121}for(i=0;i<3;i++)this.old[i]=this.star.position[i];for(h=1/e,m=42.5/h,i=0;i<pe;i+=4)for(s=0;s<4;s++){const c=this.p[i+s];let _,p,v,f,b,E,A,g,y;if(!c.dead){for(A=c.delta[0],g=c.delta[1],y=c.delta[2],r=0;r<this.numStreams;r++)_=c.position[0]-this.sparks[r].position[0],p=c.position[1]-this.sparks[r].position[1],v=c.position[2]-this.sparks[r].position[2],b=_*_+p*p+v*v,f=un/b*m,E=f/Math.sqrt(b),A-=_*E,g-=p*E,y-=v*E;if(A*=this.drag,g*=this.drag,y*=this.drag,A*A+g*g+y*y>=25e6){c.dead=!0;continue}for(c.delta[0]=A,c.delta[1]=g,c.delta[2]=y,r=0;r<3;r++)c.oldPosition[r]=c.position[r],c.position[r]+=c.delta[r]*e;c.animFrame++,c.animFrame>=64&&(c.animFrame=0),c.liveTime=n-c.startTime}}}}const I=document.createElement("canvas");I.width=window.innerWidth;I.height=window.innerHeight;document.body.appendChild(I);const J=I.getContext("webgl"),Ie=jt(J),He=Jt(J),Fe=T(),_n=M(0,0,1e3),pn=M(0,0,0),mn=M(0,1,0),bt=T();rn(bt,_n,pn,mn);const re={projection:Fe,view:bt},xe=new on;xe.init(J,He,Ie);const we=[];for(let t=0;t<12;t++){const e=new dn(1800*(t+1)/13);e.init(J,He,Ie),we.push(e)}const de=new fn(xe,we,8);de.init(J,He,Ie);const $={streams:8,displayStar:!1,displaySparks:!1,useOrtho:!1},ue=new Ut({name:"flurry-js"});ue.add($,"streams",1,12,1);ue.add($,"displayStar");ue.add($,"displaySparks");ue.add($,"useOrtho").onChange(Ve);const vn=ue.addFolder("Links");vn.add({github:()=>window.open("https://github.com/mutoo/flurry-js")},"github");function Ve(){const t=I.width/I.height;if($.useOrtho){const n=1e3*t;nn(Fe,-n,n,-1e3,1e3,-2e3,2e3)}else en(Fe,45,t,.1,1e4)}window.addEventListener("resize",function(){I.width=window.innerWidth,I.height=window.innerHeight,J.viewport(0,0,I.width,I.height),Ve()},!1);function bn(t,e){xe.update(t,e),we.forEach(n=>n.update(t,e)),de.numStreams=$.streams,de.drag=Math.pow(.9965,t*85),de.update(t,e)}function gn(t){re.width=I.width,re.height=I.height,t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE),$.displayStar&&xe.draw(t,re),$.displaySparks&&we.forEach(e=>e.draw(t,re)),de.draw(t,re)}let rt=Date.now(),st=0;function gt(){const t=Date.now(),e=(t-rt)/1e3;st+=e,bn(e,st),gn(J),rt=t,requestAnimationFrame(gt)}Ve();gt();
